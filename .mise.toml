[tools]
tuist = "4.21.2"
swiftlint = "0.54.0"
swiftformat = "0.53.3"

[settings]
experimental = true

[env]
_.file = '.env'

[tasks.clean]
description = "Cleans Projects"
run = """
    #!/bin/bash
    set -euo pipefail
    rm -rf $HOME/Library/Developer/Xcode/DerivedData/
    tuist clean
"""

[tasks.lint-fix]
description = "Lint the workspace fixing issues"
run = """
    #!/bin/bash
    set -euo pipefail

    swiftformat $MISE_PROJECT_ROOT
    swiftlint lint --fix --quiet --config $MISE_PROJECT_ROOT/.swiftlint.yml $MISE_PROJECT_ROOT
"""

[tasks.lint]
description = "Lint the workspace"
run = """
    #!/bin/bash
    set -euo pipefail

    swiftformat $MISE_PROJECT_ROOT --lint
    swiftlint lint --quiet --config $MISE_PROJECT_ROOT/.swiftlint.yml $MISE_PROJECT_ROOT
"""

[tasks.build]
description = "Generate code and build project"
run = """
    #!/bin/bash
    set -euo pipefail

    $MISE_PROJECT_ROOT/Foundation/PokemonGraphClient/apollo-ios-cli generate --path $MISE_PROJECT_ROOT/Foundation/PokemonGraphClient/apollo-codegen-config.json
    tuist install
    tuist generate
"""